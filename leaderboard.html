<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbywXhhgL-HKpir9nrWZ2JXTy6mzy2a2aqJoUvss8z-LTQTmTg8SdHz4jnq5uJUCXq9lEQ/exec";

  fetch(API_URL + "?action=getLeaderboard")
    .then(response => {
      if (!response.ok) throw new Error('網路回應錯誤');
      return response.json();
    })
    .then(result => {
      const content = document.getElementById('lbContent');
      // 判斷資料結構，相容於 result.data 或直接是陣列
      const list = result.data || result;
      
      if (Array.isArray(list) && list.length > 0) {
        content.innerHTML = list.map((item, i) => `
          <div class="lb-item">
            <span>#${i+1} ${item.playerName || '無名氏'}</span>
            <strong>${item.score || 0}</strong>
          </div>`).join('');
        content.className = ""; // 移除 loading 樣式
      } else {
        content.innerHTML = "目前尚無玩家紀錄";
      }
    })
    .catch(error => {
      document.getElementById('lbContent').innerHTML = "資料讀取失敗，請確認 API 權限或稍後再試";
      console.error(error);
    });
</script>
